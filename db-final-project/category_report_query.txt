use iti330_knt35;

SET @totalduration = (select sum(time_to_sec(Duration))/60 from Viewing);

SELECT g.Genre as Genre, count(distinct tv.TV_Title) as 'Number of Shows', sum(time_to_sec(vi.Duration))/60 as 'Duration of Genre',
	100*((sum(time_to_sec(Duration))/60)/@totalduration) as 'Percentage of Total'
	FROM Genre as g
	LEFT OUTER JOIN TV_Show as tv ON g.Genre=tv.Genre 
    LEFT OUTER JOIN Viewing as vi ON tv.TV_Title=vi.TV_Title 
    GROUP BY tv.Genre ASC;
    
